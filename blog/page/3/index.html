
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>kurobaraのブログ</title>
  <meta name="author" content="kurobara">

  
  <meta name="description" content="はじめに 同僚とApacheとTomcatって何で連携させるんだっけ？
という話が出たので備忘録的に記載しておきます ぶっちゃけ、今更感がすごい内容ですが・・・ Apache ざっくり言うと、クライアントのブラウザからアクセスし、サービスを提供するためのWebサーバソフトウェア Tomcat &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://moonstruckdrops.github.com/blog/page/3/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="kurobaraのブログ" type="application/atom+xml">
  <link href="/stylesheets/table.css" rel="stylesheet" type="text/css" />

  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:moonstruckdrops.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
    <li><a href="/">
        <span class="blue_light">
            kurobaraのブログ
        </span>
       
           <span class="blue_dark">
             〜ネタを書き散らすだけのようなブログ〜
           </span>
       
    </a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <!--
  <li><a href="/about">About me</a></li>
  -->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/03/17/apache-plus-tomcat/">なぜApacheとTomcatを連携させるのか</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-03-17T00:12:00+09:00" pubdate data-updated="true">Mar 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>はじめに</h3>

<hr />

<p>同僚とApacheとTomcatって何で連携させるんだっけ？<br/>
という話が出たので備忘録的に記載しておきます</p>

<p>ぶっちゃけ、今更感がすごい内容ですが・・・</p>

<h3>Apache</h3>

<hr />

<p>ざっくり言うと、クライアントのブラウザからアクセスし、サービスを提供するためのWebサーバソフトウェア</p>

<h3>Tomcat</h3>

<hr />

<p>こちらもざっくり言うと、以下のもの</p>

<ul>
<li>「サーブレット・コンテナ」(Servlet等を動作させるために必要なWebアプリケーションサーバ)</li>
<li>Servletのインスタンス管理やセッションの管理</li>
<li>Webサーバ機能有り(主に開発とデバッグ用)</li>
</ul>


<h3>連携理由</h3>

<hr />

<p>開発、デバッグ用途としてWebサーバ機能があるので、問題はないのですが
そもそもとして、ApacheなどのWebサーバの性能と同等に捌けるかは疑問があったりするところ</p>

<p>なので、以下の処理分担としたほうが効率よく捌けるため連携をさせることが多い</p>

<ul>
<li>静的コンテンツ(HTMLや画像ファイルなど)の処理はApacheが担当(何故なら、高速でTomcatに比べて高速に処理できるから)</li>
<li>動的コンテンツに関しての処理をTomcatが担当</li>
</ul>


<p>所謂、餅は餅屋ということですな</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/18/api-life-cycle/">APIを作る際のAPIバージョンに関するメモ</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-18T23:19:00+09:00" pubdate data-updated="true">Feb 18<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>はじめに</h3>

<hr />

<p>APIを作るときにどうするか？を開発チーム内で議論したので、備忘録的なメモ</p>

<p>発端となった会話は、こんな感じだったはず</p>

<p>「マイクロアーキテクチャなサービスを作ったときってAPIを作ると思うけど、ライフサイクルって考えてる？」<br/>
「APIを利用するフロントは更新できるけど、APIは依存されるものが多いから簡単には更新できないよね？」<br/>
「APIってモバイルアプリからも利用した場合、修正しづらくない？バージョン管理でもするの？」</p>

<h3>APIの種別</h3>

<hr />

<p>以下の３つぐらいになりそう</p>

<ul>
<li>外部公開向け</li>
<li>モバイルアプリ向け</li>
<li>webサービス向け</li>
</ul>


<h3>外部公開向け</h3>

<hr />

<ul>
<li>API変更の影響が大きい</li>
<li>ドキュメント更新必須</li>
<li>利用者が離れるのでドラスティックな変更はできない</li>
<li>利用者への周知が必須</li>
</ul>


<h3>モバイルアプリ向け</h3>

<hr />

<ul>
<li>アプリのみが影響を受けるので、API変更における影響は少ない</li>
<li>アプリバージョンによるので自由にAPI更新ができない</li>
<li>OSバージョンによってアプリのアップデートができないことが多いので、更新によって使えなくなる可能性有</li>
<li>更新API対応のアプリであっても、アプリが更新されることは無いと思ったほうがよい</li>
</ul>


<h3>webサービス向け</h3>

<hr />

<ul>
<li>クライアントもAPIに合わせて最新にできるので、変更しやすい</li>
<li>キャッシュされたクライアントのコードとのデータ不整合が起きやすい</li>
<li>キャッシュに振り回される(iOSのwebview等)</li>
</ul>


<h3>バージョニング方式</h3>

<hr />

<p>APIのバージョン管理方式は以下のものが採用される傾向にある</p>

<ol>
<li>アクセス先URIそのものを大きく変更する</li>
<li>URIにバージョンを埋め込む</li>
<li>クエリに使用APIバージョンを入れる</li>
<li>メディアタイプにバージョンを指定する</li>
</ol>


<p>世間的には、2のパターンが比較的多く採用される傾向</p>

<h3>URIにバージョンを埋め込み方式</h3>

<hr />

<ul>
<li>「v1」のように「v」をつけてバージョンを明確にすることが多い</li>
<li>日付やリリースバージョン(ハッシュ等)をバージョンにするAPIもある(twillo等)</li>
<li>URIに組み込むバージョンは、メジャー番号のみを含める</li>
<li>APIの修正は、後方互換を保ちつつ対応する</li>
</ul>


<p>バージョニングは以下のセマンティックバージョニング方式を取ることが多い</p>

<ul>
<li>パッチバージョンは、ソフトウェアのAPIに変更がないバグ修正を行ったときに増える</li>
<li>マイナーバージョンは後方互換がある機能変更、特定の機能追加のときに増える</li>
<li>メジャーバージョンは後方互換が無い変更の時に増える</li>
</ul>


<h3>メディアタイプにバージョンを指定する</h3>

<hr />

<ul>
<li>「Accept: application/vnd.example.v2+json」のような形で規定する</li>
<li>URIがリソースを表しているので、HTTPの文法に則っている</li>
<li>「Content-Type」の指定誤りで、サーバ、クライアント側ともにエラーになりやすい傾向</li>
</ul>


<h3>バージョン変更指針</h3>

<hr />

<ul>
<li>APIは基本変更しないほうがよい</li>
<li>変更は後方互換を保ちつつ対応できる場合は、マイナーバージョンアップ(可能な限りこちらを選択)</li>
<li>後方互換が保てない修正の場合はメジャーバージョンアップ</li>
<li>レスポンスデータ整合性/整理のためであれば、バージョンは上げない(後方互換を維持し続け、ドキュメント整理で対応)</li>
</ul>


<h3>メジャーバージョンアップ指針</h3>

<hr />

<p>後方互換が保てない場合のみ実施し、バージョンアップのルールを整理してから行う</p>

<ul>
<li>セキュリティ/権限などのAPI使用ルール変更</li>
<li>認証方式の変更</li>
<li>乱雑に作った(ルールが無い)APIを使いやすくするための整備</li>
</ul>


<h3>APIの提供終了</h3>

<hr />

<ul>
<li>API提供終了前に提供終了日時のアナウンスをする(提供終了後、半年ほどは動かしておくこと)</li>
<li>提供終了までにAPIを利用できなくするブラックアウトテストを数回実施する</li>
<li>API提供終了の仕様をドキュメントに盛り込んでおく(HTTPのステータスコード410(Gone)を返すなど)</li>
<li>利用期限をAPI提供開始時に決めておく</li>
<li>古いAPIを叩いたときに、新APIへのリダイレクトは、混乱を招くので避けたほうがよい</li>
</ul>


<p># モバイル向けAPIの場合、ユーザー体験に直結するので仕様として予め考えておく(モバイル向けの場合、APIの停止はトレンドを見つつ行うこと)
# アプリのアップデートを促すようにしておく(強制アップデートは好まれないが、使えなくなるよりも遥かにマシ)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/02/18/linux-login-check/">Linuxのログイン履歴確認</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-02-18T01:20:00+09:00" pubdate data-updated="true">Feb 18<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>はじめに</h3>

<hr />

<p>毎度なんだっけ？ってなって思い出すのが面倒なので、備忘録的にログイン履歴確認方法を記録</p>

<h3>最近ログインしたアカウント一覧</h3>

<hr />

<p>以下のコマンドで確認できる</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$last</span></code></pre></td></tr></table></div></figure>


<p>実行結果(上に行くほど最新)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root     tty1                          Tue May  6 18:59 - crash  (00:16)
</span><span class='line'>root     tty1                          Tue May  6 18:58 - 18:59  (00:00)
</span><span class='line'>reboot   system boot  2.6.32-431.11.2. Tue May  6 17:16 - 21:21  (04:04)</span></code></pre></td></tr></table></div></figure>


<h3>ログファイルから確認する</h3>

<hr />

<p>もう少し細かく見る場合はログファイルを確認する<br/>
バイナリなので中を見たいときはwhoコマンドを使用する</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$who /var/log/wtmp</span></code></pre></td></tr></table></div></figure>


<p>実行結果(ログファイルなので、ファイル末尾が新しい)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root     tty1         2014-05-06 18:58
</span><span class='line'>root     tty1         2014-05-06 18:59
</span><span class='line'>root     tty1         2014-05-06 19:19</span></code></pre></td></tr></table></div></figure>


<h3>各アカウントの最終ログインの一覧</h3>

<hr />

<p>普段利用していないアカウントでログインされていないか確認できる<br/>
以下のコマンドで確認できる</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$lastlog</span></code></pre></td></tr></table></div></figure>


<p>実行結果(各アカウントの最終ログインが表示)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ユーザ名         ポート   場所             最近のログイン
</span><span class='line'>root             tty1                      **一度もログインしていません**
</span><span class='line'>bin                                        **一度もログインしていません**
</span><span class='line'>daemon                                     **一度もログインしていません**
</span><span class='line'>adm                                        **一度もログインしていません**
</span><span class='line'>lp                                         **一度もログインしていません**
</span><span class='line'>sync                                       **一度もログインしていません**
</span><span class='line'>shutdown                                   **一度もログインしていません**</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/28/octopress-picture/">Octopressでの画像の表示</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-28T00:55:00+09:00" pubdate data-updated="true">Jan 28<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>はじめに</h3>

<hr />

<p>常々、画像ファイルってどう表示するのだっけ？と思っていたのでやってみた感じ</p>

<h3>ファイルの格納先</h3>

<hr />

<p><code>octopress/source/images</code>ディレクトリに画像ファイルを格納する</p>

<p>themeで表示している画像が最初から格納されているので、ビビらず画像ファイルを格納すること</p>

<h3>指定方法</h3>

<hr />

<p><a href="http://octopress.org/docs/plugins/image-tag/">公式</a>を参照すればできる模様</p>

<p>そのため前述の格納先を相対URLで指定すると、以下の形になる</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>![hoge](/images/hoge.jpg)</span></code></pre></td></tr></table></div></figure>


<p>こんな感じでやると画像を表示できる</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/28/timecapsule-eth0/">TimeCapsuleのethernetを確認する</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-28T00:45:00+09:00" pubdate data-updated="true">Jan 28<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>備忘録的に</h3>

<hr />

<p>TimeCapsuleのIPアドレスを固定にしたかったので、MACアドレスを調べる必要が出てきた</p>

<p>また同じことにならないようにメモしておく</p>

<h3>確認方法</h3>

<hr />

<p>下記の図のように、AirMacユーティリティを開き機器のタイトルを選択すると表示されます</p>

<p><img src="/images/airmac.png" alt="AirMac" /></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/17/pull-to-refresh/">AndroidのPull to Refreshをちょっとだけ調べた</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-17T23:58:00+09:00" pubdate data-updated="true">Jan 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>はじめに</h3>

<hr />

<p>ここの内容は完全に備忘録です。<br/>
何故かというと、自分がちょっと実現したい機能があったけどできるのだろうかと調べてみたメモだからです。</p>

<h3>普通のPull To Refresh</h3>

<hr />

<p>所謂、下向きに引っ張るとListViewが更新されるやつですね。</p>

<p>これはAPI Level19のSupport V4 Libraryにて機能提供されているので、簡単に実現できます。<br/>
(ちょっと癖はあるかもしれませんが・・・)</p>

<p>以下にデモとReferenceを記載</p>

<ul>
<li><a href="https://developer.android.com/samples/SwipeRefreshLayoutBasic/index.html">SwipeRefreshLayoutBasic</a></li>
<li><a href="https://developer.android.com/reference/android/support/v4/widget/SwipeRefreshLayout.html">SwipeRefreshLayout</a></li>
</ul>


<p># デモを見ればわかりますが、扱うだけなら非常に楽に使えるような感じになっています(カスタムは面倒臭さそう)<br/>
# ぐぐれば、いっぱい記事は見つかるので詳細はそちらに譲ります</p>

<h3>やりたかったこと</h3>

<hr />

<p>下から上にListViewを引っ張ると、ListViewが更新されること<br/>
俗に言う、bottomup to refreshってやつです</p>

<h3>調べてみた</h3>

<hr />

<h4>ライブラリは？</h4>

<p><a href="https://github.com/chrisbanes/Android-PullToRefresh">Android-PullToRefresh</a>が、対応している
但し、作者がdeprecated宣言</p>

<h4>カスタム実装は？</h4>

<p>少し試してみた感じだと、標準機能を駆使して実現(Classの継承など)は、まず無理かも</p>

<p># そもそも、そんな感じで簡単にrefreshする機能を上下を入れ替え作られているような感じにはなってなかった</p>

<h4>ソースコードを見れば？</h4>

<p>結論から言うと、onTouchEventでアニメーションの実施の有無など詳細な条件判定とかやっているので今のところ難しそう</p>

<p><a href="https://android.googlesource.com/platform/frameworks/support/+/refs/heads/master/v4/java/android/support/v4/widget/SwipeRefreshLayout.java">SwipeRefreshLayout.java</a></p>

<p># 追いかけた結果を書くのは割愛します</p>

<h5>他の人はどうなの？</h5>

<p>同じことを考える方はいらっしゃるようですね。</p>

<p><a href="http://stackoverflow.com/questions/24867204/swiperefreshlayout-pull-from-bottom">SwipeRefreshLayout - Pull From Bottom</a></p>

<p>ざっくり書くと、こんな感じ</p>

<ul>
<li>今のAPIだと簡単には無理</li>
<li>OSSのコードをコピーして、自前で<a href="https://bitbucket.org/andreyice/swiperefreshlayoutbottom">実装</a>した</li>
<li><a href="http://www.oodlestechnologies.com/blogs/Implementing-Pull-to-refresh-(like-in-Facebook-mobile-app)-for-ANDROID-using-Titanium">ここ</a>を参考に実装すればもしかしたらできるかも</li>
</ul>


<p># ソースコード見た感触とあまり変わらない(´・ω・｀)</p>

<h3>ちょっと調べてとりあえず分かったこと</h3>

<hr />

<p>API叩いて直ぐ実現可能というわけではないようですね(´・ω・｀)</p>

<ul>
<li>クラスを継承した独自のLayoutにすればなんとかできそうかもしれない</li>
<li>但し、onTouchEventを自前で実装するのと処理中のアニメーションを挟むため、一筋縄ではいかない</li>
<li>実現方法の参考実装はあるので、うまくできそうかやってみればいいかもしれない</li>
<li>deprecated宣言しているが、ライブラリを使えば楽にはできる(その後のメンテナンスコストは払う必要は出そうだが・・・)</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/01/08/emacs-version/">Emacsのバージョンで分岐をさせたい</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-01-08T00:51:00+09:00" pubdate data-updated="true">Jan 8<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>発端</h3>

<hr />

<p>Emacsのバージョンを最新にしたことで色々設定が楽に書けることがわかった<br/>
そのため、最新内容を反映させた</p>

<p>とはいえ、下位互換もある程度保ちたかった<br/>
(全部、追従すればいいのだがそうもいかない環境もあるので)</p>

<h3>最初に試してみた</h3>

<hr />

<p>普通にバージョンを取得してみた</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(emacs-version)
</span><span class='line'>"GNU Emacs 24.4.1 (x86_64-apple-darwin14.0.0, NS apple-appkit-1343.16)
</span><span class='line'> of 2015-01-04 on hoge.local"</span></code></pre></td></tr></table></div></figure>


<p>文字列のマッチング処理が多くなりそうで結構めんどくさい・・・</p>

<h3>結果的にこうした</h3>

<hr />

<p>普通のmajor/minor バージョン判定を複合した条件判定するだけの関数を用意</p>

<p>24.3以下の判定</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(defvar is-less-than-or-equal-24-3 (and (&lt;= emacs-major-version 24) (&lt;= emacs-minor-version 3)))</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/12/22/web-api-good-parts-2/">Web API the Good Parts2章</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-12-22T23:18:00+09:00" pubdate data-updated="true">Dec 22<span>nd</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h2>前置き</h2>

<h4>近況</h4>

<hr />

<p>ざっくりと書くと、お前エンジニアなのに勉強しなくていいの？という状態</p>

<ol>
<li>免許が取れたので単車を乗り回している(運転が楽しくて毎日、運転しているような)</li>
<li>昨年よりも比較的、仲がいい友人(男女問わず)と遊ぶ機会が多くなったかも&#8230;</li>
<li>気の合う仲間と組んで、(Swiftで)アプリ作っている</li>
<li>その気の合う仲間への技術指導していたり&#8230;</li>
</ol>


<p>なんだか、教えることが多くなって自分が学習している時間が比較的減ってきているそんな感じががが</p>

<h4>そういう訳なので</h4>

<hr />

<p>本屋でざっくりと見かけてツボに嵌った本を読んでいこうかと</p>

<p>「Web API The Good Parts」</p>

<p>なのですが、上記3,4が結構あるので中々進まないという(ぉぃ</p>

<p>ということなので、なるたけ気になるところ(覚えておくべきところ)だけまとめていこうかなと</p>

<p>斜め読みした感じでは、結構ツボに嵌る内容なので自分のバイブルに入選してもいいかなと思ってたり。</p>

<h2>エンドポイント設計</h2>

<ol>
<li>公開する機能を先に設計する</li>
<li>覚えやすく、どんな機能を持つURIかひと目で分かるようにする</li>
<li>HTTPメソッドの活用</li>
<li>設計の注意点</li>
<li>クエリパラメータ</li>
<li>ログインや認証</li>
<li>ホスト名とエンドポイント</li>
</ol>


<h4>1に関して</h4>

<hr />

<p>どんなAPIが必要かどうかを先に洗い出しておく</p>

<h4>2に関して</h4>

<hr />

<ul>
<li>短く入力しやすいURI</li>
<li>人間が読んで理解できるURI</li>
<li>大文字、小文字が混在しないURI</li>
<li>改造しやすいURI</li>
<li>サーバ側アーキテクチャが反映されていないURI</li>
<li>ルールが統一されたURI</li>
</ul>


<h4>3に関して</h4>

<hr />

<p>HTTPメソッドを有効活用</p>

<ul>
<li>Restfulな形で活用すれば、一般的な形</li>
</ul>


<h4>4に関して</h4>

<hr />

<ul>
<li>複数形の名詞を利用する</li>
<li>利用する単語に気をつける((ProgramableWeb)[http://www.programmableweb.com/]等、他のサービスを参考に)</li>
<li>スペースやエンコードが必要な文字は避ける</li>
<li>単語をつなげる場合はハイフンにする(SEO的に有利なことも)</li>
</ul>


<h4>5に関して</h4>

<hr />

<ul>
<li>相対位置を使用する場合、データ数が多くなると取得件数が減ること、更新頻度が高いものは不整合が起きやすくなることに注意</li>
<li>絶対位置を使用する場合、クエリパラメータが「x以降」,「この日付よりも古いもの」という形でクエリパラメータをもたせたほうがよい</li>
<li>日付の形式は、RFC3339に規定されている「1970-01-01T00:00:00Z」の形にする</li>
<li>絞り込みのパラメータは、「q」のような形は曖昧検索に取られやすいので完全一致の場合は適切なパラメータにすること</li>
<li>一意なリソースを表すのに必要な情報: パス</li>
<li>省略可能: クエリパラメータ</li>
</ul>


<h4>6に関して</h4>

<hr />

<ul>
<li>OAuthを使用して、標準的な形にする</li>
</ul>


<p>標準的なOAuthに則るとエラーメッセージ(RFC6749, RFC6750)は、以下のような形式となる
(当然ながらhttpステータスは401)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>{
</span><span class='line'>  "error": "invalid_token"
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>


<h4>7に関して</h4>

<hr />

<ul>
<li>ホスト名にapiを入れるのが主流</li>
<li>企業で複数のサービスをホストする場合、例外的なホスト名</li>
<li>サービスとしてのapiの場合はホスト名にapiをいれたほうがよい(外部から使われるため)</li>
<li>プラットフォームの場合、service等をホスト名にいれる</li>
</ul>


<h2>まとめ</h2>

<hr />

<ul>
<li>一般的なURI設計がそのまま適用できる</li>
<li>APIならではのルール、デファクトスタンダードがある</li>
<li>URIはリソースを表すものなので、URIとHTTPメソッドの組み合わせで処理の対象と内容を設計をする</li>
</ul>


<h4>Good</h4>

<ul>
<li>覚えやすく、どんな機能を持つかが一目で分かるようにエンドポイントにする</li>
<li>適切なHTTPメソッドを利用する</li>
<li>適切な英単語を利用し、単数形、複数形にも注意する</li>
<li>認証はOAuth2.0を使う</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/15/back-multi-modal/">iOSで複数のmodalを同時に閉じる</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-15T17:02:00+09:00" pubdate data-updated="true">Nov 15<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>こんな状況</h3>

<hr />

<p>[A→B→C→Dの順で画面を開いた状況で、D->Aへ戻りたいという状況</p>

<h3>やり方</h3>

<hr />

<p>戻りたいところのmodalを指定すると、その前のものは全て閉じることができました</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>self.presentingViewController?.presentingViewController?.dismissViewControllerAnimated(true, completion: nil)</span></code></pre></td></tr></table></div></figure>


<p>画面遷移の状態を覚えてないと辛い感じですね</p>

<h3>元ネタ</h3>

<hr />

<p><a href="dismissViewControllerAnimated:completion:">https://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/index.html#//apple_ref/occ/instm/UIViewController/dismissViewControllerAnimated:completion:</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/11/09/reload-config-emacs/">Emacsを再起動せずに設定を反映させる</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-09T12:23:00+09:00" pubdate data-updated="true">Nov 9<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>やりたいこと</h3>

<hr />

<p>Emacsを再起動せず、設定内容を反映させたい</p>

<h3>解決編</h3>

<hr />

<p>追加した部分だけ、評価する</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>M-x eval-region</span></code></pre></td></tr></table></div></figure>


<p>今、現在実行している全てのバッファの式を再評価する</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>M-x eval-buffer</span></code></pre></td></tr></table></div></figure>


<p>そもそもの設定ファイルを読みなおす</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>M-x load-file RET ~/.emacs.d/init.el</span></code></pre></td></tr></table></div></figure>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/4/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/2/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>どうやらSEをやっているらしい。</p>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/06/16/use-git-branch-command/">gitのブランチ系コマンドでよく使うもの</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/04/02/kotlin-study-for-kansai/">Kotlin 1.0リリース記念勉強会 in 京都に行ってきた</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/23/rails-mimetype/">Railsのリクエストヘッダーを調べる</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/02/07/sudo-and-x-and-ssh/">sshでX11 Forwardingをsudoコマンド時に実施する方法</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/12/30/walkman-playlist-converter/">GroovyでWALKMAN用のプレイリストコンバーターを作成した</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Tag Cloud</h1>
  <span id="tag-cloud"><a href='/blog/categories/android' style='font-size: 125.71428571428572%'>Android(9)</a> <a href='/blog/categories/api' style='font-size: 105.71428571428571%'>API(2)</a> <a href='/blog/categories/devlove' style='font-size: 102.85714285714286%'>DevLove(1)</a> <a href='/blog/categories/devops' style='font-size: 102.85714285714286%'>DevOps(1)</a> <a href='/blog/categories/emacs' style='font-size: 114.28571428571429%'>Emacs(5)</a> <a href='/blog/categories/gas' style='font-size: 102.85714285714286%'>GAS(1)</a> <a href='/blog/categories/git' style='font-size: 111.42857142857143%'>git(4)</a> <a href='/blog/categories/git' style='font-size: 102.85714285714286%'>Git(1)</a> <a href='/blog/categories/go' style='font-size: 102.85714285714286%'>Go(1)</a> <a href='/blog/categories/googlemap' style='font-size: 102.85714285714286%'>GoogleMap(1)</a> <a href='/blog/categories/groovy' style='font-size: 102.85714285714286%'>Groovy(1)</a> <a href='/blog/categories/hackathon' style='font-size: 102.85714285714286%'>Hackathon(1)</a> <a href='/blog/categories/ide' style='font-size: 102.85714285714286%'>IDE(1)</a> <a href='/blog/categories/ios' style='font-size: 102.85714285714286%'>iOS(1)</a> <a href='/blog/categories/java' style='font-size: 120.0%'>Java(7)</a> <a href='/blog/categories/javascript' style='font-size: 102.85714285714286%'>JavaScript(1)</a> <a href='/blog/categories/kotlin' style='font-size: 102.85714285714286%'>Kotlin(1)</a> <a href='/blog/categories/linux' style='font-size: 131.42857142857142%'>Linux(11)</a> <a href='/blog/categories/mac' style='font-size: 117.14285714285714%'>Mac(6)</a> <a href='/blog/categories/markdown' style='font-size: 117.14285714285714%'>markdown(6)</a> <a href='/blog/categories/mysql' style='font-size: 102.85714285714286%'>MySQL(1)</a> <a href='/blog/categories/python' style='font-size: 102.85714285714286%'>Python(1)</a> <a href='/blog/categories/ruby' style='font-size: 160.0%'>Ruby(21)</a> <a href='/blog/categories/shellscript' style='font-size: 102.85714285714286%'>ShellScript(1)</a> <a href='/blog/categories/solr' style='font-size: 102.85714285714286%'>Solr(1)</a> <a href='/blog/categories/戯言' style='font-size: 122.85714285714286%'>戯言(8)</a> </span>
</section






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - kurobara -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
